# Power Distribution

## What is the purpose of the board?
A power distribution board is necessary to supply power to the various subsystems in the vehicle. This board performs distribution, startup, shutdown and emergency shutdown as required in regulations. In addition to supporting powering the boards, it also powers components directly, such as the horn, camera and others.

More information about the board can be found here:
https://uwmidsun.atlassian.net/wiki/spaces/ELEC/pages/846201173/Power+Distribution+MS+14

This consists of the front power distribution and the back power distribution. They both control different parts of the vehicle.
The links below specifies what is controlled by the front power distribution and what is controlled by the back power distribution.
https://uwmidsun.atlassian.net/wiki/spaces/ELEC/pages/850657322/Front+Power+Distribution
https://uwmidsun.atlassian.net/wiki/spaces/ELEC/pages/850363109/Rear+Power+Distribution

## What are all the things that the firmware needs to do?
A description of what firmware needs to do is given here:
https://uwmidsun.atlassian.net/wiki/spaces/ELEC/pages/1271071005/Firmware+overview

## How does it work?
* bps_watcher - Watches for the BPS_HEARTBEAT to make sure that no fault has occured
* can_rx_event_mapper_config - Standard configurations for can_rx_event_mapper
* can_rx_event_mapper - Maps CAN messages to power distribution events
* current_measurement_config - Standard configurations for current_measurement
* current_measurement - Periodically reads current from load switches and exposes global storage
* front_uv_detector - Checks if undervoltage cutoff has occurred on front PD and sends a CAN message
* main - Initializes all other modules
* output_config - Standard configurations for output
* output - General-purpose module for manipulating the outputs that power distribution controls
* pd_fan_ctrl - Control fans for front and rear power distro via ADT7476A
* pd_gpio_config - Standard configurations for pd_gpio
* pd_gpio - Receive events and set the PCA9539R GPIO pin states as specified
* publish_data_config - Standard configurations for publish_data
* publish_data - Publishes current measurements over CAN as generated by current_measurement
* rear_strobe_blinker - Blinks the strobe light, controlled by PD_STROBE_EVENT
